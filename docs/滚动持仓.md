滚动持仓（Rolling Holdings）的再平衡逻辑，以下是为您整理的详细解答：

核心结论
卖出的仓位大小会直接影响新买入 10 个 ETF 的初始净值。

逻辑解析
通过分析代码（如 compare_rolling_vs_periodic.py）和交易流水（rolling_T14_details_trades.csv），我们可以清晰地看到滚动持仓的运作机制：

资金分片（Independent Tranches）： 策略将初始资金平均分为 T 份（例如 T=14，每份约 7.14%）。每份资金被视为一个独立的“子账户”或“批次”（Tranche）。
批次内部循环（Intra-Tranche Rebalancing）： 每个批次每 T 个交易日进行一次完全换仓。
步骤 A：卖出该批次当前持有的所有 ETF，资金回到该批次的“现金池”。
步骤 B：计算该批次的当前总市值（已结算现金 + 剩余未卖出的残值）。
步骤 C：将该批次的“当前总市值”平分成 10 份，买入新的 10 只 ETF。
收益滚存（Compounding Effect）： 批次之间是不调剂资金的。
如果批次 1 在过去 14 天里大涨了 20%，那么换仓时，它卖出的总金额就会比 14 天前多。
因此，它买入新 10 只 ETF 的每只初始仓位都会比上次增加 20%。
反之，如果亏损，新仓位的初始净值也会同步萎缩。
为什么这样做更稳健？
这种逻辑实现了局部的复利增长（Compound Interest），同时避免了像“定期全仓调仓”那样在某一天全额波动的巨大冲击力。

定期调仓：就像每 12 天把所有水缸里的水倒在一起，再重新平均分。
滚动持仓：就像有 14 个水缸，每天只倒一个缸里的水。水缸里的水越多（赚了钱），重新装满时每份水就越多。
您在交易流水中可以看到，2024年9月初每只买入约 7.1万，到了9月26日第一次换仓时，每只买入已经增长到了 7.7万 左右，这正是前期盈利直接滚入新仓位的体现。

Task
Open
继续探讨这里的:
批次内部循环（Intra-Tranche Rebalancing）： 每个批次每 T 个交易日进行一次完全换仓。
步骤 A：卖出该批次当前持有的所有 ETF，资金回到该批次的“现金池”。
步骤 B：计算该批次的当前总市值（已结算现金 + 剩余未卖出的残值）。
步骤 C：将该批次的“当前总市值”平分成 10 份，买入新的 10 只 ETF。



10支ETF等权
#### 🛡️ 风险控制：天然的“减速带”
*   **逻辑**：当批次市值缩水时，后续新买入的 10 只 ETF 绝对金额随之下降。
*   **价值与意义**：
    1.  **降敞口**：在策略回撤期，自动降低投入市场的绝对资金量（真金白银），减缓净值下跌速度。
    2.  **稳杠杆**：凯利公式告诉我们，风险资产应始终占当前家底的固定比例。这种做法确保了你不会在亏损时因为坚持原始金额而导致“被动放大杠杆”。
    3.  **拒加死码**：本质上是承认当前选股或择时失败，并拒绝在失败的方向上加筹码，符合“截断亏损”的实战生存原则。
