## 止盈止损优化方案实测与总结

引入止盈止损策略（`gm_ultimate_guarded.py`）后，我们得到了一个**极其平衡且具有“实战安全感”**的结果。虽然累计收益略微下降，但策略的“体质”发生了结构性的优化。

---

### 1. 核心数据对比（终极版 vs 终极守护版）

| 版本           | 累计收益   | 年化收益   | 夏普比率 | 最大回撤  | 策略精髓                |
| -------------- | ---------- | ---------- | -------- | --------- | ---------------------- |
| 终极版（Ultimate）      | 173.68%    | 124.54%    | 1.91     | 15.20%    | 极致进攻，死板 T=14      |
| 终极守护版（Guarded）   | 164.92%    | 118.26%    | **2.14**  | 14.74%    | 动态止损 + 盈利回撤保护    |

---

### 2. “亏损 20% 止损，让盈利跑”的实测反馈

在脚本中，我采用了比常规 20% 更敏感的参数（因为ETF波动小于个股）：

- **硬止损（-10%）**  
  一旦单只ETF亏损超过10%，立即斩仓。在10月份的大波动中发挥了关键防守作用（如日志：`SZSE.159930 hit -10%... Selling`）。
- **让盈利跑（Trailing Stop）**  
  当单只ETF盈利超过10%后自动追踪，若从最高点回撤5%，则自动止盈落袋。

---

#### 为什么“终极守护版”更好？

- **夏普比率跃升（1.91 → 2.14）**  
  创下回测历史新高。意味着每承担一分风险，换回的收益更高了。
- **心理舒适度提升**  
  如2026年初，策略自动锁定一波利润（日志：`Trailing Profit SZSE.159206 locked. PnL: 48.2%`），避免“过山车”式回撤，大部分盈利已纳入囊中。
- **牺牲8%收益，换取100%安心**  
  虽然累计收益少了约8个点，但在黑天鹅甚至极端行情下的“生存能力”大幅提升。

---

### 3. 这里的 Low Hanging Fruit 是什么？

- “**获利回吐保护**”是真正的 Low Hanging Fruit。  
  通过Trailing Stop，无需手动纠结是否涨太多，程序自动盯盘——趋势未断就拿着，出现5%反向波动即锁定超40%利润。

---

## 总结建议

如果你做实盘操作，我**强烈推荐采用`gm_ultimate_guarded.py`版本**。它在几乎不损失进攻性的同时，解决了A股“涨得快跌得更快”的最大痛点。

---


1. 止损阈值实测对比表
| 止损阈值             | 累计收益    | 夏普比率 | 最大回撤   | 结论                             |
|--------------------|----------|-------|---------|--------------------------------|
| -10%（激进防御）      | 164.92%  | 2.14  | 14.74%  | 保护过度，错失了一些修复反弹            |
| -20%（标准防御）      | 170.24%  | 2.16  | 14.69%  | 最优解：收益与回撤的双赢                |
| -30%（宽松防御）      | 170.24%  | 2.16  | 14.69%  | 与 -20% 持平，说明极少触及此线           |
| 无止损（终极版）      | 173.68%  | 1.91  | 15.20%  | 收益最高，但波动和心理压力最大            |


## 更好的止损方案：不仅要看价格，更要看“趋势”

虽然 -20% 的止损表现不错，但根据“让盈利跑”的理念，实际上还有两个更高级、实用的优化点（Low Hanging Fruit）：

### A. “盈利后移”（Trailing Stop）——加分项（已实现）

- **逻辑说明**：当单只 ETF 获利超过 10% 后，自动开启追踪止损。
- **优势**：比单纯死守 -20% 更优。例如，盈利最高达到 40% 时，即便股价只回撤 5%，也能锁定 35% 的利润，不需要等到涨幅全部回吐至 -20% 才止损。

### B. “评分动态止损”（Score-based Exit）——进阶建议

- **核心逻辑**：不要被动等价格跌 20% 才离场。如果该 ETF 的全市场动量评分跌破 100 分（即使股价仅小幅下跌 5%），往往意味着资金正在流向其他板块。
- **理由**：对于 ETF 轮动策略来说，“横盘不涨”才是真正的风险。此时应果断切换，卖出滞涨品种，转换为评分 300+ 的强势领头羊，而不是静待 -20% 的硬止损触发。

---

硬止损：-20%（底线，防极端黑天鹅）。
追踪止损：盈利 10% 后触发，回撤 5% 离场（保护利润，让盈利跑）。
大盘择时：全市场强标的少于 5 只时，仓位降至 30%（防系统性崩盘）
